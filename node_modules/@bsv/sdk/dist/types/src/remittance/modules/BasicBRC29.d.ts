import type { RemittanceOptionId, Termination } from '../types.js';
import type { ModuleContext } from '../types.js';
import type { RemittanceModule } from '../RemittanceModule.js';
import type { WalletInterface, WalletCounterparty, PubKeyHex, WalletProtocol } from '../../wallet/Wallet.interfaces.js';
/**
 * BRC-29-like payment option terms.
 *
 * This module intentionally keeps option terms minimal:
 * - Amount is taken from the invoice total (and validated as satoshis)
 * - The payer derives the payee's per-payment public key using wallet.getPublicKey with a stable protocolID
 */
export interface Brc29OptionTerms {
    /** Payment amount in satoshis. */
    amountSatoshis: number;
    /** The recipient of the payment */
    payee: PubKeyHex;
    /** Which output index to internalize, default 0. */
    outputIndex?: number;
    /** Optionally override the protocolID used in getPublicKey. */
    protocolID?: WalletProtocol;
    /** Optional labels for createAction. */
    labels?: string[];
    /** Optional description for createAction. */
    description?: string;
}
/**
 * Settlement artifact carried in the settlement message.
 */
export interface Brc29SettlementArtifact {
    customInstructions: {
        derivationPrefix: string;
        derivationSuffix: string;
    };
    transaction: number[];
    amountSatoshis: number;
    outputIndex?: number;
}
/**
 * Receipt data for BRC-29 settlements.
 */
export interface Brc29ReceiptData {
    /** Result returned from wallet.internalizeAction, if accepted. */
    internalizeResult?: unknown;
    /** Human-readable rejection reason, if rejected. */
    rejectedReason?: string;
    /** If rejected with refund, contains the refund payment token. */
    refund?: {
        token: Brc29SettlementArtifact;
        feeSatoshis: number;
    };
}
export interface NonceProvider {
    createNonce: (wallet: WalletInterface, scope: WalletCounterparty, originator?: unknown) => Promise<string>;
}
export interface LockingScriptProvider {
    /** Converts a public key string to a P2PKH locking script hex. */
    pubKeyToP2PKHLockingScript: (publicKey: string) => Promise<string> | string;
}
/**
 * Default nonce provider using SDK createNonce.
 */
export declare const DefaultNonceProvider: NonceProvider;
/**
 * Default locking script provider using SDK P2PKH template.
 */
export declare const DefaultLockingScriptProvider: LockingScriptProvider;
export interface Brc29RemittanceModuleConfig {
    /** Default protocolID to use with wallet.getPublicKey. */
    protocolID?: WalletProtocol;
    /** Labels applied to created actions. */
    labels?: string[];
    /** Description applied to created actions. */
    description?: string;
    /** Output description for created actions. */
    outputDescription?: string;
    /**
     * Fee charged on refunds, in satoshis.
     */
    refundFeeSatoshis?: number;
    /**
     * Minimum refund to issue. If refund would be smaller, module will reject without refund.
     */
    minRefundSatoshis?: number;
    /** How wallet internalizes the payment. */
    internalizeProtocol?: 'wallet payment' | 'basket insertion';
    nonceProvider?: NonceProvider;
    lockingScriptProvider?: LockingScriptProvider;
}
/**
 * BRC-29-based remittance module.
 * - payer creates a payment action to a derived P2PKH output
 * - payer sends { tx, derivationPrefix, derivationSuffix } as settlement artifact
 * - payee internalizes the tx output using wallet.internalizeAction
 * - optional rejection can include a refund token embedded in the termination details
 */
export declare class Brc29RemittanceModule implements RemittanceModule<Brc29OptionTerms, Brc29SettlementArtifact, Brc29ReceiptData> {
    readonly id: RemittanceOptionId;
    readonly name = "BSV (BRC-29 derived P2PKH)";
    readonly allowUnsolicitedSettlements = true;
    private readonly protocolID;
    private readonly labels;
    private readonly description;
    private readonly outputDescription;
    private readonly refundFeeSatoshis;
    private readonly minRefundSatoshis;
    private readonly internalizeProtocol;
    private readonly nonceProvider;
    private readonly lockingScriptProvider;
    constructor(cfg?: Brc29RemittanceModuleConfig);
    buildSettlement(args: {
        threadId: string;
        option: Brc29OptionTerms;
        note?: string;
    }, ctx: ModuleContext): Promise<{
        action: 'settle';
        artifact: Brc29SettlementArtifact;
    } | {
        action: 'terminate';
        termination: Termination;
    }>;
    acceptSettlement(args: {
        threadId: string;
        settlement: Brc29SettlementArtifact;
        sender: PubKeyHex;
    }, ctx: ModuleContext): Promise<{
        action: 'accept';
        receiptData?: Brc29ReceiptData;
    } | {
        action: 'terminate';
        termination: Termination;
    }>;
}
//# sourceMappingURL=BasicBRC29.d.ts.map